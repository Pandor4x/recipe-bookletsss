<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Recipe Category</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .category-title {
      font-size: 2.2rem;
      color: #ff9800;
      margin: 40px 0 24px 0;
      text-align: center;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .category-grid {
      max-width: 1600px;
      margin: 0 auto 40px auto;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 38px;
    }
    .recipe-card {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.10);
      padding: 24px 18px;
      display: flex;
      align-items: center;
      gap: 24px;
      font-size: 1.25rem;
      min-height: 180px;
      cursor: pointer;
      transition: box-shadow 0.2s;
      width: 700px;
    }
    .recipe-card:hover {
      box-shadow: 0 6px 24px rgba(255,152,0,0.15);
    }
    .recipe-img-side {
      width: 140px;
      height: 140px;
      object-fit: cover;
      border-radius: 12px;
      box-shadow: 0 1px 8px rgba(0,0,0,0.08);
    }
    .recipe-details-side h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: #ff9800;
    }
    .recipe-meta {
      font-size: 1.15rem;
      color: #444;
    }
    @media (max-width: 900px) {
      .category-grid { max-width: 98vw; grid-template-columns: 1fr; gap: 22px; }
      .recipe-card { flex-direction: column; align-items: flex-start; min-height: 120px; }
      .recipe-img-side { width: 100%; height: 120px; }
      .category-title { font-size: 1.3rem; }
    }

    .site-title {
  font-size: 2.2rem;
  font-weight: bold;
  color: #ff9800;
  text-decoration: none;
  transition: color 0.2s;
  display: inline-block;
  margin-bottom: 6px;
}
.site-title:hover {
  color: #e65100;
  text-decoration: none;
}
@media (max-width: 700px) {
  .site-title {
    font-size: 1.4rem;
  }
}
  </style>
</head>
<body>
  <header>
    <div class="header-center" style="display:flex;align-items:center;gap:12px;justify-content:center;">
      <a href="index.html" class="site-title">Pandora's Recipes</a>
      <input type="text" id="headerSearchInput" class="header-search" placeholder="Search recipes..." style="max-width:360px; width:40%; padding:8px 10px; border-radius:6px; border:1px solid #ddd;">
    </div>
  </header>
  <main>
  <div style="text-align:center; margin-top:40px; margin-bottom:24px;">
    <a id="categoryTitle" class="site-title"></a>
  </div>
  <div class="category-grid" id="categoryRecipeList"></div>
</main>
  <footer>
    <div class="footer-links">
      <a href="about.html">About Us</a>
      <span>|</span>
      <a href="terms.html">Terms of Service</a>
      <span>|</span>
      <a href="contact.html">Contact Us</a>
      <span>|</span>
      <a href="privacy.html">Privacy Policy</a>
    </div>
  </footer>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="firebase.js"></script>
  <script>
    // Local search box: Enter -> go to index with query
    (function(){
      const input = document.getElementById('headerSearchInput');
      if (!input) return;
      input.addEventListener('keydown', function(e){
        if (e.key === 'Enter') {
          e.preventDefault();
          const q = (input.value || '').toString().trim();
          window.location.href = q ? `index.html?q=${encodeURIComponent(q)}` : 'index.html';
        }
      });
    })();
  // Example: fetch recipes by category
  const API_URL = 'https://pandor4x-pandorax-backend.onrender.com';
  const params = new URLSearchParams(window.location.search);
const category = params.get('type') || 'Breakfast';
document.getElementById('categoryTitle').textContent = formatCategoryLabel(category) + " Recipes";

// Local category canonicalization (same rules as main script)
const CATEGORY_MAP = { 'appetizer':'breakfast', 'main dish':'dinner', 'dessert':'desserts', 'beverage':'lunch' };
function canonicalizeCategory(raw){ if(!raw) return ''; const s = raw.toString().trim().toLowerCase(); if(CATEGORY_MAP[s]) return CATEGORY_MAP[s]; if(s==='dessert') return 'desserts'; return s; }
function formatCategoryLabel(raw){ const c = canonicalizeCategory(raw||''); if(!c) return ''; return c.charAt(0).toUpperCase()+c.slice(1); }

async function loadRecipes() {
  try {
    const res = await fetch(`${API_URL}/api/recipes?category=${category}`);
    const recipes = await res.json();

    const list = document.getElementById("categoryRecipeList");
    list.innerHTML = "";

    if (!recipes.length) {
      list.innerHTML = `<div style="grid-column:1/-1;text-align:center;color:#888;font-size:1.2rem;padding:40px 0;">No recipes found for ${category}.</div>`;
      return;
    }

    recipes.forEach(r => {
      const card = document.createElement("div");
      card.className = "recipe-card";
      card.innerHTML = `
        <div class="recipe-card-flex">
          ${r.image ? `<img src="${r.image}" alt="Recipe Image" class="recipe-img-side">` : `<div class="recipe-img-side placeholder"></div>`}
          <div class="recipe-details-side">
            <div class="card-header">
              <h3 class="recipe-title">${r.title}</h3>
              <span class="category-badge">${formatCategoryLabel(r.category) || ''}</span>
            </div>
            <p class="recipe-description">${((r.description || '').length > 140) ? (r.description || '').slice(0,137) + '...' : (r.description || '')}</p>
            <div class="recipe-meta">‚≠ê 0.0</div>
          </div>
        </div>
      `;
      card.onclick = () => window.location.href = `recipe.html?id=${r.id}`;
      list.appendChild(card);
    });

  } catch (err) {
    console.error(err);
  }
}

loadRecipes();

  </script>
</body>
</html>